# CHTL项目详细分析文档

## 项目概述
CHTL是基于C++语言实现的超文本语言，其本质是为了提供一种更符合开发者编写HTML代码的方式，使用MIT开源协议。

## 文档结构分析

### 第一部分：基础语法 (1-95行)
1. **注释系统** (4-9行)
   - `//` 单行注释
   - `/**/` 多行注释  
   - `--` 生成器识别注释

2. **文本节点** (11-29行)
   - `text { }` 语法
   - `text:` 属性语法

3. **字面量** (31-45行)
   - 无修饰字面量（无引号字符串）
   - 双引号字符串 `""`
   - 单引号字符串 `''`

4. **CE对等式** (47-50行)
   - `:` 与 `=` 完全等价

5. **元素节点** (52-78行)
   - 支持所有HTML元素
   - 块级、行内、行内块元素

6. **属性** (81-94行)
   - `属性名 : "属性值";` 语法

### 第二部分：样式系统 (97-306行)
1. **局部样式块** (97-101行)
   - 元素内部嵌套 `style {}`
   - 支持内联样式、类选择器、id选择器、伪类选择器、伪元素选择器

2. **内联样式** (103-118行)
   - 直接在 `style{}` 内部添加属性

3. **自动化类名/id** (121-136行)
   - 自动添加类名/id
   - 无需手动编写class/id

4. **上下文推导** (139-166行)
   - 使用 `&` 表示类名/id
   - 根据上下文推导

5. **属性运算** (169-173行)
   - 支持算术运算符 `+ - * / % **`
   - 直接进行算术运算

6. **引用属性** (175-207行)
   - 引用其他元素的属性值
   - 语法：`CSS选择器.属性`

7. **属性条件表达式** (210-306行)
   - 三元运算符 `? :`
   - 链式调用
   - 可选选项
   - 算术运算符
   - 逻辑运算符 `&& ||`
   - 引用属性条件表达式

### 第三部分：模板系统 (308-437行)
1. **样式组模板** (312-328行)
   - `[Template] @Style 组名` 语法

2. **元素模板** (331-369行)
   - `[Template] @Element 元素名` 语法

3. **变量组模板** (372-402行)
   - `[Template] @Var 变量组名` 语法

4. **组合继承** (405-437行)
   - 模板继承
   - 显性继承 `inherit`

### 第四部分：自定义系统 (439-735行)
1. **自定义样式组** (446-537行)
   - 无值样式组
   - 样式组特例化
   - 删除属性
   - 删除样式组继承

2. **自定义元素** (539-734行)
   - 自定义元素特例化
   - 增加样式
   - 索引访问
   - 插入元素
   - 删除元素
   - 删除元素继承

3. **变量组** (737-752行)
   - 变量组特例化

4. **全缀名** (755-778行)
   - 访问模板元素、样式组、变量组

### 第五部分：原始嵌入 (781-832行)
1. **嵌入HTML代码** (788-801行)
   - `[Origin] @Html` 语法

2. **嵌入CSS代码** (804-809行)
   - `[Origin] @Style` 语法

3. **嵌入JS代码** (812-817行)
   - `[Origin] @JavaScript` 语法

4. **带名原始嵌入** (820-831行)
   - 为原始嵌入块赋予名称

### 第六部分：导入系统 (834-1014行)
1. **导入HTML、CSS、JS文件** (838-851行)
   - `[Import] @Html from 路径 as 命名`
   - `[Import] @Style from 路径 as 命名`
   - `[Import] @JavaScript from 路径 as 命名`

2. **导入CHTL文件** (853-910行)
   - 精确导入
   - 类型导入
   - 通配导入

3. **路径对等式** (911-912行)
   - `.` 与 `/` 等价

4. **命名空间** (914-1014行)
   - `[Namespace]` 语法
   - 命名空间嵌套
   - 冲突检测策略

### 第七部分：约束系统 (1020-1055行)
1. **精确约束** (1023-1030行)
   - `except` 关键字

2. **类型约束** (1033-1042行)
   - 禁止特定类型

3. **全局约束** (1045-1054行)
   - 命名空间内使用

### 第八部分：配置系统 (1057-1228行)
1. **配置组** (1057-1069行)
   - `[Configuration]` 语法

2. **Name配置** (1072-1128行)
   - 自定义关键字名称

3. **命名配置组** (1132-1148行)
   - 命名配置组

4. **导入配置组** (1151-1158行)
   - 导入配置组

5. **局部样式块自动化规则** (1160-1175行)
   - 禁用自动添加类/id

6. **默认命名空间** (1177-1184行)
   - 禁用默认命名空间功能

7. **自定义原始嵌入类型** (1187-1228行)
   - 创建自定义类型

### 第九部分：use语法 (1229-1245行)
1. **HTML5类型** (1233-1238行)
   - `use html5;` 语法

2. **使用命名配置组** (1240-1245行)
   - `use @Config Basic;` 语法

### 第十部分：CHTL JS (1247-1573行)
1. **文件后缀** (1256-1257行)
   - `*.cjjs` 文件

2. **文件载入** (1259-1279行)
   - `fileloader {}` 语法

3. **局部script** (1282-1312行)
   - 元素内部 `script{}` 语法

4. **增强选择器** (1315-1364行)
   - `{{CSS选择器}}` 语法

5. **明确使用CHTL语法** (1366-1386行)
   - `->` 代替 `.`

6. **增强监听器** (1389-1419行)
   - `listen` 语法

7. **事件委托** (1422-1439行)
   - `delegate` 语法

8. **动画** (1441-1480行)
   - `animate` 语法

9. **虚对象** (1483-1517行)
   - `vir` 语法

10. **路由** (1519-1548行)
    - `router` 语法

11. **动态属性条件表达式** (1550-1571行)
    - 动态属性条件

### 第十一部分：模块系统 (1574-1913行)
1. **模块路径** (1575-1586行)
   - 源码文件夹、官方模块目录、用户模块目录

2. **CMOD** (1588-1794行)
   - 模块结构
   - 模块信息
   - 包含子模块的模块结构
   - 模块的导入

3. **CJMOD** (1693-1752行)
   - 模块结构
   - 模块信息
   - 包含子模块的模块结构
   - 模块的导入

4. **CMOD + CJMOD** (1754-1785行)
   - 混合模块结构

5. **通配符** (1787-1908行)
   - 通配符导入

6. **官方模块** (1800-1913行)
   - 官方模块前缀
   - Chtholly模块
   - Yuigahama模块

### 第十二部分：项目结构 (1914-1964行)
- 详细的目录结构建议

### 第十三部分：项目流程 (1966-2012行)
- 编译流程图表

### 第十四部分：语法边界 (2022-2029行)
- 各语法块的限制

### 第十五部分：CJMOD API (2031-2254行)
1. **简介** (2032-2035行)
2. **CJMOD API** (2036-2254行)
   - Syntax类
   - Arg类
   - CJMODScanner类
   - CJMODGenerator类
   - AtomArg类
   - CHTLJSFunction类

### 第十六部分：统一扫描器 (2255-2406行)
1. **概述** (2256-2258行)
2. **可变长度切片与智能扩增** (2260-2261行)
3. **占位符机制** (2263-2406行)
   - 双指针扫描
   - 前置截取
   - 宽判严判

### 第十七部分：CLI (2408-2416行)
- 常规命令行与命令行程序

### 第十八部分：VSCode IDE (2418-2441行)
- IDE功能要求

## 技术栈选择
根据文档分析，建议使用Rust作为主要开发语言，原因：
1. 高性能编译
2. 内存安全
3. 优秀的错误处理
4. 强大的模式匹配
5. 丰富的生态系统

## 核心组件架构
1. **词法分析器 (Lexer)**
2. **语法分析器 (Parser)**
3. **AST构建器**
4. **代码生成器**
5. **模块系统**
6. **统一扫描器**
7. **CJMOD API**
8. **CLI工具**
9. **VSCode扩展**